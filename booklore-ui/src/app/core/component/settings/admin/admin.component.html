<div class="p-4">
  <p-button outlined="true" label="Create User" (onClick)="openCreateUserDialog()"></p-button>

  <p-table [value]="users" class="mt-4">
    <ng-template pTemplate="header">
      <tr>
        <th>Username</th>
        <th>Full Name</th>
        <th>Email</th>
        <th style="width: 100px;">Can Upload</th>
        <th style="width: 100px;">Can Download</th>
        <th style="width: 100px;">Can Edit Metadata</th>
        <th style="width: 100px;">Edit</th>
        <th style="width: 100px;">Delete</th>
      </tr>
    </ng-template>

    <ng-template pTemplate="body" let-user>
      <tr>
        <td>{{ user.username }}</td>
        <td>
          <input *ngIf="user.isEditing" type="text" [(ngModel)]="user.name" class="p-inputtext w-full"/>
          <span *ngIf="!user.isEditing">{{ user.name }}</span>
        </td>
        <td>
          <input *ngIf="user.isEditing" type="email" [(ngModel)]="user.email" class="p-inputtext w-full"/>
          <span *ngIf="!user.isEditing">{{ user.email }}</span>
        </td>
        <td class="text-center">
          <p-checkbox [binary]="true" [(ngModel)]="user.permissions.canUpload" *ngIf="user.isEditing"></p-checkbox>
          <p-checkbox [binary]="true" [(ngModel)]="user.permissions.canUpload" disabled *ngIf="!user.isEditing"></p-checkbox>
        </td>
        <td class="text-center">
          <p-checkbox [binary]="true" [(ngModel)]="user.permissions.canDownload" *ngIf="user.isEditing"></p-checkbox>
          <p-checkbox [binary]="true" [(ngModel)]="user.permissions.canDownload" disabled *ngIf="!user.isEditing"></p-checkbox>
        </td>
        <td class="text-center">
          <p-checkbox [binary]="true" [(ngModel)]="user.permissions.canEditMetadata" *ngIf="user.isEditing"></p-checkbox>
          <p-checkbox [binary]="true" [(ngModel)]="user.permissions.canEditMetadata" disabled *ngIf="!user.isEditing"></p-checkbox>
        </td>
        <td class="text-center">
          <ng-container *ngIf="user.username !== 'admin'">
            <p-button *ngIf="!user.isEditing" icon="pi pi-pencil" outlined="true" severity="primary" (onClick)="toggleEdit(user)"></p-button>
            <p-button *ngIf="user.isEditing" icon="pi pi-check" outlined="true" severity="success" (onClick)="saveUser(user)"></p-button>
            <p-button *ngIf="user.isEditing" icon="pi pi-times" outlined="true" severity="danger" (onClick)="toggleEdit(user)"></p-button>
          </ng-container>
          <p-button *ngIf="user.username === 'admin'"
                    icon="pi pi-pencil"
                    outlined="true"
                    severity="primary"
                    [ngStyle]="{'visibility': 'hidden'}">
          </p-button>
        </td>
        <td class="text-center">
          <ng-container *ngIf="user.username !== 'admin'">
            <p-button icon="pi pi-trash" outlined="true" severity="danger" (onClick)="deleteUser(user)"></p-button>
          </ng-container>
        </td>
      </tr>
    </ng-template>
  </p-table>
</div>
